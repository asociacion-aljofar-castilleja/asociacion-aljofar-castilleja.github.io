---
import { getEntry } from "astro:content";

type Lang = "es" | "en";
type Social = { nombre?: string; handle?: string; url?: string; icon?: string };

interface Props {
  lang: Lang;
  items: Social[];
  titleOverride?: string;
}

const { lang, items = [], titleOverride } = Astro.props;

// i18n
const idMap = { es: "sociallinks/es", en: "sociallinks/en" } as const;
type I18n = { title?: string; ariaSection?: string; ariaLink?: string; empty?: string };
const entry = await getEntry({ collection: "ui", id: idMap[lang] });
const I = (entry?.data ?? {}) as I18n;

const title = titleOverride ?? I.title ?? (lang === "en" ? "Social media" : "Redes sociales");
const ariaSection = I.ariaSection ?? title;
const ariaLink = (name?: string) =>
  String(I.ariaLink ?? (lang === "en" ? "Open {{name}} profile" : "Abrir perfil en {{name}}")).replace("{{name}}", name ?? "social");
const emptyText = I.empty ?? (lang === "en" ? "No social profiles yet." : "AÃºn no hay perfiles sociales.");
---

<section class="social-links py-3" aria-label={ariaSection} data-module="SocialLinks">
  <div class="container">
    <h2 class="h4 mb-3">{title}</h2>

    {items.length === 0 ? (
      <p class="text-muted">{emptyText}</p>
    ) : (
      <ul class="social-list list-unstyled m-0 row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
        {items.map((s) => (
          <li class="col d-flex">
            <a class="social-card card border-0 shadow-sm w-100 align-items-center justify-content-center d-flex p-3"
               href={s.url ?? "#"} target="_blank" rel="noopener" aria-label={ariaLink(s.nombre)}>
              <span class={`social-icon social-icon--${(s.icon ?? "").toLowerCase()}`} aria-hidden="true"></span>
              <span class="ms-2">
                <strong>{s.nombre}</strong>
                {s.handle && <span class="d-block text-muted small">{s.handle}</span>}
              </span>
            </a>
          </li>
        ))}
      </ul>
    )}
  </div>
</section>
