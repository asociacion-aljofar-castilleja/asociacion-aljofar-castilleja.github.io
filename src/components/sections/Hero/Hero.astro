---
import { getEntry } from "astro:content";

type Lang = "es" | "en";
interface Props {
  lang: Lang;
  lema?: string;
  subtitle?: string;
  ctaText?: string;
  ctaHref?: string;
  bg?: string;              // ruta imagen
  minHeightVH?: number;     // alto mínimo (vh), por defecto 65
}

const {
  lang,
  lema,
  subtitle,
  ctaText,
  ctaHref,
  bg,
  minHeightVH = 65,
} = Astro.props as Props;

// i18n del componente (colección 'ui', ids Hero/es|en)
const idMap = { es: "hero/es", en: "hero/en" } as const;
type HeroI18n = {
  lema?: string; subtitle?: string; ctaText?: string; ctaHref?: string; bg?: string;
};
const entry = await getEntry({ collection: "ui", id: idMap[lang] });
const I = (entry?.data ?? {}) as HeroI18n;

// Merge: props > i18n > defaults
const LEMA      = lema     ?? I.lema     ?? (lang === "en" ? "Technology with social impact" : "Tecnología con impacto social");
const SUBTITLE  = subtitle ?? I.subtitle ?? "";
const CTA_TEXT  = ctaText  ?? I.ctaText  ?? (lang === "en" ? "Learn more" : "Descubre más");
const CTA_HREF  = ctaHref  ?? I.ctaHref  ?? (lang === "en" ? "#what-we-do" : "#que-hacemos");
const BG        = bg       ?? I.bg       ?? "/img/hero.jpg";
---

<section
  class="hero position-relative overflow-hidden text-white"
  data-module="Hero"
  style={`--hero-minvh:${minHeightVH}vh; --hero-bg:url(${BG});`}
  aria-label={LEMA}
>
  <!-- Fondo + overlay -->
  <div class="hero__bg" aria-hidden="true"></div>
  <div class="hero__overlay" aria-hidden="true"></div>

  <div class="container position-relative">
    <div class="row align-items-center hero__row">
      <div class="col-12 col-lg-7">
        <h1 class="display-4 fw-bold lh-1 mb-3">{LEMA}</h1>
        {SUBTITLE && <p class="lead mb-4">{SUBTITLE}</p>}
        <a class="btn btn-primary btn-lg shadow" href={CTA_HREF} aria-label={CTA_TEXT}>{CTA_TEXT}</a>
      </div>
    </div>
  </div>
</section>
